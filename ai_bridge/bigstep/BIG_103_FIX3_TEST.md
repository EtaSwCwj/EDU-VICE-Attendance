# BIG_103_FIX3: 페이지 인식/수정/경고 개선 테스트

> 생성일: 2024-12-28
> 목표: 페이지 수정 기능, 분권별 경고 메시지, 촬영 기록 표시 테스트

---

## ⚠️ 수정 내용 요약

### 1. book_camera_page.dart - 페이지 번호 수정 기능
- 인식된 페이지 번호 탭하면 수정 다이얼로그
- "탭하여 수정" 안내 표시
- 인식 실패(?) 시에도 직접 입력 가능

### 2. answer_camera_page.dart - 분권별 범위 경고
- 상단에 "등록된 페이지 범위" 섹션 추가
  - 본책: p.1~19
  - Work Book: p.23~31
- 범위 초과 경고 다이얼로그에 분권별 정보 표시
- 가능한 원인 안내 개선

### 3. problem_camera_page.dart - 촬영 기록 표시
- "이번 세션 촬영 기록 (X건)" 섹션
- 촬영할 때마다 목록에 추가
- "촬영 완료 (X건 저장)" 버튼

### 4. book_detail_page.dart - 경고 메시지 개선
- 분권별 범위 표시
- "책 정보 수정에서 페이지 범위를 확인하세요" 안내

---

## ⚠️ 필수: Opus는 직접 작업 금지!

```bash
claude --model claude-sonnet-4-20250514 --dangerously-skip-permissions -p "작업 내용"
```

---

## ⚠️ 컨텍스트 관리 (필수!)

```
1. 스몰스텝 2~3개 완료할 때마다 로그 저장
2. 로그 저장 후 /compact 실행 → 확인 묻지 말고 바로 다음 작업
3. 파일 생성은 Sonnet한테 1개씩 시키기 (한 번에 여러 파일 X)
```

---

## 환경

- 프로젝트: C:\gitproject\EDU-VICE-Attendance
- Flutter 앱: flutter_application_1/
- 폰 디바이스: RFCY40MNBLL
- 테스트 계정: maknae12@gmail.com

---

## 🎯 기대 결과 & 테스트 시나리오

### CP 테스트 시나리오

**사전 조건:**
- 2권 구성 책 등록 (본책 + 워크북)
- 각 Volume에 페이지 범위 설정되어 있어야 함

---

**테스트 1: 페이지 번호 수정 기능**
```
1. 책 상세 → "정답지 등록" 또는 "문제 촬영"
2. 카메라 촬영 시작
3. 아무 페이지 촬영
4. 인식 결과 화면에서:
   → "탭하여 수정" 안내 보이는지 확인
   → 페이지 번호 옆에 ✏️ 아이콘 있는지 확인
5. 페이지 번호 탭
6. 수정 다이얼로그에서 올바른 번호 입력
7. 확인 → 수정된 번호로 표시
```

**테스트 2: 정답지 등록 - 분권별 범위 표시**
```
1. 책 상세 → "정답지 등록"
2. 상단에 "등록된 페이지 범위" 섹션 확인:
   → 본책: p.X~Y
   → Work Book: p.A~B
3. 범위 확인 후 PDF 업로드 또는 촬영
```

**테스트 3: 범위 초과 경고 - 분권별 정보**
```
사전: 책 totalPages를 작게 설정 (예: 50페이지)

1. 정답지 등록 → PDF 업로드
2. 100페이지가 인식됨 (범위 초과)
3. 경고 다이얼로그 확인:
   → "📚 등록된 책 페이지 범위" 섹션
   → 본책: p.1~X
   → Work Book: p.Y~Z
   → 총 50페이지
   → "⚠️ 범위 초과 페이지: 100p"
   → 가능한 원인 안내
```

**테스트 4: 문제 촬영 - 세션 기록 표시**
```
1. "문제 촬영" 클릭
2. Volume 선택 → 촬영 시작
3. 1장 촬영 → 페이지 확인/수정 → 확인
4. 하단에 "이번 세션 촬영 기록 (1건)" 섹션 표시
   → "Xp" 
   → "본책 • HH:MM"
5. 다시 촬영 → 2건째 추가
6. "촬영 완료 (2건 저장)" 버튼 표시
```

**테스트 5: 책 상세 - 분권별 경고**
```
사전: 범위 초과 페이지가 등록된 상태

1. 책 상세 페이지
2. "등록된 정답지 페이지" 펼치기
3. 초과 페이지는 빨간 태그
4. 하단 경고 박스:
   → "페이지 범위 불일치"
   → 본책: p.X~Y
   → Work Book: p.A~B
   → "→ 일부 등록된 페이지가 이 범위를 초과합니다"
   → "책 정보 수정에서 페이지 범위를 확인하세요"
```

---

## 스몰스텝

### 1. flutter analyze

- [ ] Sonnet 지시:
```
cd C:\gitproject\EDU-VICE-Attendance\flutter_application_1
flutter analyze 실행하고 결과 알려줘
```
- [ ] 에러 0개 확인
- [ ] 완료 후 로그 저장: `ai_bridge/logs/big_103_fix3_step_01.log`

### 2. 폰 빌드

- [ ] Sonnet 지시:
```
cd C:\gitproject\EDU-VICE-Attendance\flutter_application_1
flutter run -d RFCY40MNBLL 실행해줘
빌드 완료되면 "빌드 완료" 알려줘
```
- [ ] 빌드 성공 확인
- [ ] 완료 후 로그 저장: `ai_bridge/logs/big_103_fix3_step_02.log`
- [ ] `/compact` 실행 후 바로 다음 진행

### 3. CP 테스트 대기

- [ ] CP에게 테스트 시나리오 안내
- [ ] 로그 모니터링하면서 대기
- [ ] CP 피드백 수집

### 4. CP "테스트 종료" 대기

- [ ] CP가 "테스트 종료" 입력 시 보고서 작성
- [ ] 보고서 파일: `ai_bridge/report/big_103_fix3_report.md`

---

## 검증 규칙 (v7.3)

- 에러 메시지만 보고 실패 판정 금지
- 실제 화면/동작 확인 후 판정

---

## 로그 저장

각 스몰스텝 완료 시:
- ai_bridge/logs/big_103_fix3_step_XX.log

---

## 완료 조건

1. flutter analyze 에러 0개
2. 테스트 1~5 통과 (CP 확인)
3. CP가 "테스트 종료" 입력
4. 보고서 작성 완료 (ai_bridge/report/big_103_fix3_report.md)

---

## 📝 알려진 제한사항

**페이지 인식 정확도 문제 (2번 이슈)**
- cunning_document_scanner의 자동 테두리 감지 품질 문제
- 대각선 자르기, 저해상도 등
- 근본 해결: 스캐너 라이브러리 교체 또는 후처리 개선 필요
- 현재 대응: 수동 수정 기능으로 보완
